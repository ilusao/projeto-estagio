<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Gestão de Produtos</title>
    <link rel="stylesheet" href="Bootstrap/css/bootstrap.css" />
    <link rel="stylesheet" href="Bootstrap/bootstrap-icons.css" />
    <link rel="stylesheet" href="produtos.css" />
    <script src="chart.min.js"></script>
</head>
<body>
<div class="container py-4">
    <h2 class="text-center mb-4">Gestão de Produtos</h2>

    <!-- Navegação -->
    <ul class="nav nav-tabs" id="tabMenu" role="tablist">
        <li class="nav-item">
            <a class="nav-link active" id="pedidos-tab" data-bs-toggle="tab" href="#pedidos" role="tab">Pedidos de Produtos</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" id="estoque-tab" data-bs-toggle="tab" href="#estoque" role="tab">Estoque / Consumo</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" id="graficos-tab" data-bs-toggle="tab" href="#graficos" role="tab">Relatórios / Gráficos</a>
        </li>
    </ul>

    <!-- Conteúdo das Abas -->
    <div class="tab-content mt-3">
        <!-- Aba 1: Pedidos -->
        <div class="tab-pane fade show active" id="pedidos" role="tabpanel">
            <h4>Adicionar Pedido de Produto</h4>
            <div id="listaProdutos">
                <!-- Os produtos serão inseridos pelo JS -->
            </div>
            <button id="finalizarPedidos" class="btn btn-success mt-3">
                <i class="bi bi-check-circle me-1"></i> Finalizar Pedidos
            </button>
        </div>

        <!-- Aba 2: Estoque -->
        <div class="tab-pane fade" id="estoque" role="tabpanel">
            <h4>Estoque / Consumo</h4>
            <table class="table table-bordered table-striped" id="tabelaEstoque">
                <thead class="table-dark">
                <tr>
                    <th>Produto</th>
                    <th>Quantidade</th>
                    <th>Data</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>Canetão</td>
                    <td>5</td>
                    <td>10/09/2025</td>
                </tr>
                </tbody>
            </table>
        </div>

        <!-- Aba 3: Gráficos -->
        <div class="tab-pane fade" id="graficos" role="tabpanel">
            <h4>Relatórios / Gasto Mensal</h4>
            <canvas id="graficoMes" width="400" height="200"></canvas>
        </div>
    </div>
</div>

<script src="Bootstrap/js/bootstrap.bundle.js"></script>
<script>

    function carregarProdutosDoBanco() {
        // Recebe JSON do Android
        const produtosJson = Android.getProdutosCartazista();
        const produtos = JSON.parse(produtosJson);

        const listaDiv = document.getElementById('listaProdutos');
        listaDiv.innerHTML = ''; // limpar

        produtos.forEach(prod => {
            const div = document.createElement('div');
            div.className = "mb-3 d-flex align-items-center";

            div.innerHTML = `
                <label class="form-label me-2" style="width: 250px;">${prod.descricao}</label>
                <button class="btn btn-outline-secondary btn-sm me-1" type="button">-</button>
                <input type="number" class="form-control form-control-sm me-1" value="0" min="0" style="width: 70px;">
                <button class="btn btn-outline-secondary btn-sm me-2" type="button">+</button>
            `;

            listaDiv.appendChild(div);

            const input = div.querySelector('input');
            const btnMais = div.querySelectorAll('button')[1];
            const btnMenos = div.querySelectorAll('button')[0];

            btnMais.addEventListener('click', () => { input.value = parseInt(input.value) + 1; });
            btnMenos.addEventListener('click', () => { if(parseInt(input.value) > 0) input.value = parseInt(input.value) - 1; });
        });
    }

    // Chama assim que a página carregar
    document.addEventListener("DOMContentLoaded", carregarProdutosDoBanco);

</script>
</body>
</html>
